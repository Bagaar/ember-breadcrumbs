stages:
  - test

test-addon:
  image: git.bagaar.be:4567/docker/nodejs:9.11.1
  script:
    # install chrome
    - wget -q -O - https://dl-ssl.google.com/linux/linux_signing_key.pub | apt-key add -
    - echo "deb http://dl.google.com/linux/chrome/deb/ stable main" > /etc/apt/sources.list.d/google.list
    - apt-get update -yqqq
    - apt-get install -y google-chrome-stable > /dev/null 2>&1

    # write .env file
    # - echo "$ENV_FILE" > .env
    # - sed -i 's/\r /\n/g' .env

    # install dependencies
    - npm install --silent

    # run tests
    # - npm run nodetest
    - npm run test
  stage: test
  tags:
    - docker-ci
